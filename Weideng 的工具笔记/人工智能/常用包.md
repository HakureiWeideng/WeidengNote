# 常用包

## NumPy

- [NumPy 官网](https://numpy.org/)

一个开源的 Python 语言扩展程序库。

- 底层大量基于 C 语言。
- 支持多维数组与矩阵的快速运算。

### 基本概念

- np

	常用别名。`import numpy as np`

- Ndarray

	多维数组。NumPy 的数组只能包含相同类型的元素。

- axis

  轴。每一个线性的数组是一个轴，也即维度（Dimension）

  - 二维数组

  	`axis = 0` 代表平面横轴方向，`axis = 1` 代表平面纵轴方向。

  - 三维数组

  	`axis = 2` 代表立方体的第三个轴方向。

  - 多维数组

  	考虑将低维的数组抽象为单个元素，再按三维或二维数组思考。

![image-20220531145401023](images/常用包/image-20220531145401023.png)

- rank

	秩。轴的数量，也即维度的数量。
	
- 维度长度

  `shape` 显示的数字是维度长度。

### 构建数组

```python
np.array()
	依据参数创建一个 Ndarry 对象。
np.asarray()
	转换为一个 Ndarry 对象。
ndarray.copy()
	创建一个副本。

np.empty()
	创建一个未初始化的空数组。
np.zeros()
	创建元素全为 0 的数组。
np.ones()
	创建元素全为 1 的数组。
np.identity()
	创建单位数组
np.eye()
	创建单位数组


np.arange(start, stop, step, dtype)
	生成数组
np.linspace()
	创建等差数列数组
np.logspace()
	创建等比数列数组
```

### 切片

与 Python 一致，但 NumPy 可设置切片对象 slice 。

```python
np.slice()
	创建切片对象


in:
a = np.array([[1,2,3], [3,4,5], [4,5,6]])  
print (a[...,1])   # 第 2 列元素
print (a[1,...])   # 第 2 行元素
print (a[...,1:])  # 第 2 列及剩下的所有元素

out:
[2 4 5]
[3 4 5]
[[2 3]
 [4 5]
 [5 6]]
```

### 高级索引

NumPy 提供了比 Python 更多的索引方式。	

- 整数索引

	用两个数组分别表示行下标和列下标。

- 布尔索引

	可使用布尔数组或布尔运算筛选数据。如 `arr[x > 5]` 将索引出所有大于 $5$ 的元素。

- 花式索引

	索引出元素对应的整个轴的数据。

### 广播

（Broadcast）

当两个形状不同的数组相互运算时会触发广播机制。

- 将各维度的长度的较大值作为结果数组的各维度的长度。
- 当对应维度的长度相等或有一个长度为 $1$ 时才能正确运算。
- 运算结果会将形状较小的数组的数据进行重复，从而使对应维度扩充到相等长度才运算。

### 数组操作

```python
np.reshape()
	不改变数据修改形状。
np.flat
	数组元素迭代器。 for x in ndarray.flat:
np.flatten()
	将数组展平为一维数组，返回拷贝。
np.ravel()
	将数组展平为一维数组，作为原数组的视图。


形状变换
np.transpose()
	对换指定的轴，若不指定参数，则对换所有轴，相当于转置。
ndarray.T
	转置
np.rollaxis()
	将指定轴移动。
np.swapaxes()
	对换数组的轴。
np.squeeze()
	去除长度为 1 的维度。
np.resize()
	改变数组的形状，返回副本，当新形状比原形状大时，会出现元素重复。


借助广播变换形状
np.broadcast(arr1, arr2)
	返回两个数组的广播结果。
np.broadcast_to()
	将一个数组广播到指定的形状，返回只读视图。
np.expand_dims()
	增加指定维度的长度，原数据会被重新划分。


连接数组
np.concatenate()
	将数组在指定维度上连接（指定维度外形状相同），不增加维度，只增加维度长度。
np.stack()
	将数组的指定维度在新的维度上连接（相同形状），不增加维度长度，增加维度。


分割数组
np.split()
	传入一个整数，表示划分子数组的大小。
    传入一个数组，表示每个划分子数组的最后一个元素的位置，用以指示分割点。
    
    
元素修改
np.append()
	在指定维度末尾增加元素，不指定轴会返回一维数组。
np.insert()
	在指定维度的指定位置插入元素，不指定轴会返回一维数组。
np.delete()
	删除元素，不指定轴会返回一维数组。
np.unique(arr, return_index = false, return_inverse = false, return_counts = false)
	返回去重后的列表。
	return_index : 额外返回新列表元素在旧列表中的下标。
	return_inverse : 额外返回旧列表元素在新列表中的下标。
    return_counts : 额外返回去重数组中的元素在原数组中的出现次数。
```

### 字符串

可对字符串或字符串列表进行操作。

```python
np.char.add()
	对两个字符串数组逐个对应连接。
np.char.mutltiply()
	返回将字符串重复指定次后的字符串。
np.char.center()
	返回指定长度的将指定字符串居中，两边以指定字符填充的字符串。
np.char.capitalize()
	将字符串的首字符转换为大写。
np.char.title()
	将每个单词的首字符转换为大写。
np.char.lower()
	转换为小写。
np.char.upper()
	转换为大写。
np.char.split()
	指定分隔符对字符串进行分割，返回数组。
np.char.splitlines()
	返回字符串中的行列表，以换行符分割。
np.char.strip()
	移除字符串开头或结尾的特定字符。
np.char.join()
	指定分隔符连接数组中的元素。
np.char.replace()
	替换字符串中的所有相应子字符串。
```

### 数学

```python
sin() cos() tan()
around()
floor()
ceil()

np.reciprocal()
	返回逐元素的倒数。
np.power()
	返回对应各元素的幂。
    可传入两个数组，前一个指定各底数，后一个指定各幂次。
np.mod() np.remainder()
	返回对应元素取余后的余数。
    可传入两个数组，前一个指定各被除数，后一个指定各除数。
   

np.amax() np.amin()
	返回沿指定轴的最大最小值。
np.ptp()
	返回沿指定轴的最大最小值之差（极差）
np.percentile()
	返回指定的百分位数。
np.median()
	返回中位数。
np.mean()
	返回算术平均值。
np.average()
	返回指定权值的算术平均值。
np.std()
	返回标准差。
np.var()
	返回方差。
```

### 额外库

- `numpy.matlib`

	矩阵库。

- `numpy.linalg`

	线性代数库。

## Matplotlib

- [Matplotlib 官网](https://matplotlib.org/stable/index.html)

	其中的 Example 模块可做图形检索，复制代码。

一个开源到绘图库，可以绘制静态，动态，交互式图表。

### 基本概念

- Pyplot

  Pyplot 是 Matplotlib 的子库，提供了和 MATLAB 类似的绘图 API ，用以绘制 2D 图形。

- plt

	Pyplot 的常用别名 。`import matplotlib.pyplot as plt`

- Axes3D

	3D 绘图模块，包含了 3D 绘图需要用到的接口。`from mpl_toolkits.mplot3d import Axes3D`

### 基本函数

```python
plt.figure()
	定义一个图形窗口。
plt.plot()
	画出图形
plt.show()
	显示图像
    
    
plt.xlabel() plt.ylabel()
	横纵坐标标签。
plt.xlim() plt.ylim()
	横纵坐标轴范围。
plt.xticks() plt.yticks()
	横纵轴刻度以及刻度标签。
    刻度标签可使用 LaTeX 数学公式。
plt.legend()
	图例
    
    
plt.annotate()
	添加特殊标注。
plt.text()
	添加文本注释。
```

### plot 函数

```python
plot([x], y, [fmt])
	单条线
plot([x1], y1, [fmt1], [x2], y2, [fmt2])
	多条线

color
	颜色

marker
	点形
    
linestyle
    线形
    
fmt
	组合参数
	fmt = '[color][marker][linestyle]'

可向 plot 指定起点和终点坐标，从而画出一条任意直线。
```

常用颜色：

| 参数 | 颜色                          |
| ---- | ----------------------------- |
| g    | 绿（green）                   |
| b    | 蓝（blue）                    |
| r    | 红（red）                     |
| y    | 黄（yellow）                  |
| k    | 黑（black）（b 已被蓝色占用） |
| w    | 白（white）                   |

常用点型：

| 参数 | 点型 |
| ---- | ---- |
| `.`  | 点   |
| `o`  | 圆心 |
| `*`  | 星形 |
| `x`  | 叉形 |
| `|`  | 竖线 |
| `_`  | 横线 |

常用线型：

| 参数 | 线型   |
| ---- | ------ |
| `-`  | 实线   |
| `--` | 虚线   |
| `-.` | 点画线 |
| `:`  | 点线   |

### 参考线

```python
plt.axhline(x, c, ls, lw)
	水平参考线
plt.axvline(y, c, ls, lw)
	竖直参考线
    
x y
	参考线在坐标轴上的刻度起点。
c
	线条颜色
ls
	线形
lw
	线宽
```

### 3D 图形

```python
导入模块
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D


定义图像窗口，关联 3D 模块。
fig = plt.figure()
ax = Axes3D(fig)


准备数据


使用 ax 中的绘图函数即可绘制 3D 图形。
```

### 子图

多个图表在一张图像中显示，这些图表即是子图。

#### 均匀子图

```python
plt.subplot(2, 3, 1)
	指定将整张图分为 2 行 3 列，当前子图在第 1 个位置。

然后使用 plt.plot() 画出该子图即可。
```

#### 不均匀子图

- 先画大图，再画小图。

绘制示例：

![image-20220601092448877](images/常用包/image-20220601092448877.png)

```python
plt.subplot(2,1,1)   # 划分为 2 行 1 列，在第 1 个位置
plt.plot([0,1],[0,1])

plt.subplot(2,3,4)   # 重新划分为 2 行 3 列，在第 4 个位置
plt.plot([0,1],[0,2])   # 大图占据了整个第 1 行的 3 列位置。

plt.subplot(235)    # 划分为 2 行 3 列，在第 5 个位置
plt.plot([0,1],[0,3])

plt.subplot(236)
plt.plot([0,1],[0,4])

plt.show()
```

#### 分格画法

当子图较复杂时，重新划分的方法就不便于使用。

```python
plt.subplot2grid((2,3), (0, 0), rowspan=3, colspan=2)
	划分为 2 行 3 列，从 0 行 0 列开始画图，行跨度为 3，列跨度为 2 。
```

### 图中图

在大图中层叠显示小图。

```python
指定大图的 位置 宽高，四个参数都是占 fig 面板的百分比。
ax1 = fig.add_axes([left, bottom, width, height])

ax1.plot(x, y, 'r')


画小图方法一、
left, bottom, width, height = 0.2, 0.6, 0.25, 0.25   # 指定小图的位置与宽高
ax2 = fig.add_axes([left, bottom, width, height])
ax2.plot(y, x, 'b')


画小图方法二、
plt.axes([0.6, 0.2, 0.25, 0.25])   # 该函数也可
plt.plot(y[::-1], x, 'g') # 注意对y进行了逆序处理
```

## Pandas

- [Pandas 官网](https://pandas.pydata.org/)

一个开源库。

特性：

- 易于使用的数据结构。
- 便利的数据分析工具。

### 基本概念

- pd

	常用别名。`import pandas as pd`

- Series

	数据类型，类似表格的一列，包含索引和数据，支持任何数据类型。

- DataFrame

	表格型数据类型，有行索引和列索引。

### Series

- 数据和索引均可为任意类型。

```python
pd.Series( data, index, dtype, name, copy)

data
	一维数据
index
	索引，如果不指定，默认为 0 开始的数字。
传入字典    
	可由字典创建 Series 。
    可使用 index 筛选字典中的数据。
    
dtype
	数据类型，可默认。
name
	该列的名称。
copy
	是否拷贝数据，默认为 False。
    
返回一个 Series 对象。
```

### DataFrame

```python
pd.DataFrame( data, index, columns, dtype, copy)

data
	二维数据
index
	索引值，即行标签，行索引。
columns
	列标签，亦列索引
传入字典数组
	会将 key 作为列标签，空的 value 会显示为 NaN 。

取列数据
df[]
    
取行的某些列数据
df.ix[]
	可使用数字表示第几行，也可用行列索引。
    df.ix[a:b, c:d]   # 取 a 到 b 行，c 到 d 列。
df.loc[]
	只能使用行列索引。
df.iloc[]
	只能使用数字索引。
    
取单个数据
df.iat[a,b]
	取 a 行 b 列，只能数字索引。
df.at[]
	只能行列索引。
    
可在 [] 中使用条件表达式取行。


df = df.drop(df[df.score < 50].index)
	删除 score < 50 的所有行。
```

### 其它函数

```python
df = pd.read_csv()
	读取 CSV 文件，构建 DataFrame 。
df.to_csv()
	保存 DataFrame 为 CSV 文件。
    
df.head(n = 5)
	返回开头 n 行。
df.tail(n = 5)
	返回末尾 n 行。
df,info()
	返回表格基本信息。
```

### 数据清洗

空值类型：

- NaN

	（Not a Number）float 类型。

- NaT

	（Not a Time）时间日期类型。

- None

	NoneType 类型。

#### 空值缺失值

```python
df.dropna(axis=0, how='any', thresh=None, subset=None, inplace=False)
	删除含有空值的行

axis
	默认为 0，表示逢空值剔除整行，如果设置参数 axis＝1 表示逢空值去掉整列。
how
	默认为 'any' 如果一行（或一列）里任何一个数据有出现 NA 就去掉整行
    如果为 'all' 一行（或列）都是 NA 才去掉这整行。
thresh
	设置需要多少非空值的数据才可以保留下来。
subset
	设置想要检查的列。如果是多个列，可以使用列名的 list 作为参数。
inplace
	如果设置 True，将计算得到的值直接覆盖之前的值并返回 None，修改的是源数据。
    
    
missing_values = ["a", "b", "c"]
df = pd.read_csv('data.csv', na_values = missing_values)
	指定空值
    
    
df.fillna(n, inplace = True)
	用 n 替换空值，可指定列。
```

#### 重复数据

```python
pd.duplicated()
	返回布尔列表，如果对应位置的值与之前的元素有重复，则为 true 。

pd.drop_duplicates(inplace=True)
	删除重复值。
```

## Scikit-Learn

- [Scikit_Learn 官网](https://scikit-learn.org/stable/)









## PyTorch

[PyTorch 官网](https://pytorch.org/)

一个开源的机器学习库，主要由 Facebook 开发。

- 底层由 C++ 实现。
- 支持张量计算，可使用 GPU 加速。
- 带自动微分系统的神经网络。

### 基本概念

- Tensor

	张量。泪水 NumPy 的 Ndarray ，但能使用 GPU 加速。

### 神经网络构建基本流程

- 准备数据
- 定义模型
	- 层次设置
	- 损失函数
- 训练
	- 梯度下降
- 验证
- 测试